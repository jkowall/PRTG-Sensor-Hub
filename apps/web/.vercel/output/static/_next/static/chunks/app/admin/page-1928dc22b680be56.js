(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{4220:(e,t,r)=>{Promise.resolve().then(r.bind(r,5782))},5782:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(5155),n=r(2115),a=r(8818);let i=r(5704).env.NEXT_PUBLIC_API_URL||"/api/v1";function o(){let{user:e,token:t,loading:r}=(0,a.A)(),[o,l]=(0,n.useState)(null),[d,c]=(0,n.useState)([]),[p,x]=(0,n.useState)([]),[h,g]=(0,n.useState)(null),[u,m]=(0,n.useState)("stats"),[y,v]=(0,n.useState)(null);(0,n.useEffect)(()=>{t&&(null==e?void 0:e.is_admin)&&(j(),f(),b())},[t,e]);let j=async()=>{try{let e=await fetch("".concat(i,"/admin/stats"),{headers:{Authorization:"Bearer ".concat(t)}});e.ok&&l(await e.json())}catch(e){console.error("Failed to fetch stats:",e)}},f=async()=>{try{let e=await fetch("".concat(i,"/admin/users"),{headers:{Authorization:"Bearer ".concat(t)}});if(e.ok){let t=await e.json();c(t.items)}}catch(e){console.error("Failed to fetch users:",e)}},b=async()=>{try{let e=await fetch("".concat(i,"/admin/sensors"),{headers:{Authorization:"Bearer ".concat(t)}});if(e.ok){let t=await e.json();x(t.items)}}catch(e){console.error("Failed to fetch sensors:",e)}},S=async(e,r)=>{try{(await fetch("".concat(i,"/admin/users/").concat(e),{method:"PATCH",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({is_admin:r})})).ok&&f()}catch(e){console.error("Failed to update user:",e)}},A=async(e,r)=>{try{(await fetch("".concat(i,"/admin/sensors/").concat(e,"/certify"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({certified:"certified"===r,status:r})})).ok&&b()}catch(e){console.error("Failed to update sensor status:",e)}},k=async e=>{if(confirm("Are you sure you want to delete this sensor?"))try{(await fetch("".concat(i,"/admin/sensors/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok&&(b(),j())}catch(e){console.error("Failed to delete sensor:",e)}},C=async(e,r)=>{try{let s=await fetch("".concat(i,"/admin/sensors/").concat(e),{method:"PATCH",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(r)});if(s.ok)b(),g(null);else{let e=await s.json();v(e.error||"Failed to update sensor")}}catch(e){console.error("Failed to update sensor details:",e),v("An error occurred while updating sensor")}};return r?(0,s.jsx)("div",{className:"container",style:{padding:"80px 24px",textAlign:"center"},children:(0,s.jsx)("div",{className:"spinner"})}):e?e.is_admin?(0,s.jsxs)("div",{className:"container",style:{padding:"40px 24px"},children:[(0,s.jsx)("h1",{style:{marginBottom:"32px"},children:"Admin Dashboard"}),(0,s.jsx)("div",{style:{display:"flex",gap:"8px",marginBottom:"32px"},children:["stats","users","sensors"].map(e=>(0,s.jsx)("button",{onClick:()=>m(e),className:"category-pill ".concat(u===e?"active":""),style:{textTransform:"capitalize"},children:e},e))}),"stats"===u&&o&&(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"24px"},children:[(0,s.jsxs)("div",{className:"sensor-card",children:[(0,s.jsx)("div",{style:{fontSize:"2.5rem",fontWeight:"700",color:"var(--accent-primary)"},children:o.total_users}),(0,s.jsx)("div",{style:{color:"var(--text-secondary)"},children:"Total Users"})]}),(0,s.jsxs)("div",{className:"sensor-card",children:[(0,s.jsx)("div",{style:{fontSize:"2.5rem",fontWeight:"700",color:"var(--accent-secondary)"},children:o.total_sensors}),(0,s.jsx)("div",{style:{color:"var(--text-secondary)"},children:"Total Sensors"})]}),(0,s.jsxs)("div",{className:"sensor-card",children:[(0,s.jsx)("div",{style:{fontSize:"2.5rem",fontWeight:"700",color:"var(--success)"},children:o.total_versions}),(0,s.jsx)("div",{style:{color:"var(--text-secondary)"},children:"Total Versions"})]}),(0,s.jsxs)("div",{className:"sensor-card",children:[(0,s.jsx)("div",{style:{fontSize:"2.5rem",fontWeight:"700",color:"var(--warning)"},children:o.total_downloads.toLocaleString()}),(0,s.jsx)("div",{style:{color:"var(--text-secondary)"},children:"Total Downloads"})]})]}),"users"===u&&(0,s.jsx)("div",{style:{background:"var(--bg-card)",borderRadius:"var(--border-radius)",overflow:"hidden"},children:(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[(0,s.jsx)("th",{style:{padding:"16px",textAlign:"left"},children:"User"}),(0,s.jsx)("th",{style:{padding:"16px",textAlign:"left"},children:"Email"}),(0,s.jsx)("th",{style:{padding:"16px",textAlign:"center"},children:"Admin"}),(0,s.jsx)("th",{style:{padding:"16px",textAlign:"right"},children:"Actions"})]})}),(0,s.jsx)("tbody",{children:d.map(t=>(0,s.jsxs)("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[(0,s.jsx)("td",{style:{padding:"16px"},children:(0,s.jsx)("strong",{children:t.github_username||t.full_name||"Unknown"})}),(0,s.jsx)("td",{style:{padding:"16px",color:"var(--text-secondary)"},children:t.email}),(0,s.jsx)("td",{style:{padding:"16px",textAlign:"center"},children:t.is_admin?"✓":""}),(0,s.jsx)("td",{style:{padding:"16px",textAlign:"right"},children:t.id!==e.id&&(0,s.jsx)("button",{onClick:()=>S(t.id,!t.is_admin),className:"btn btn-outline",style:{padding:"4px 12px",fontSize:"0.8rem"},children:t.is_admin?"Remove Admin":"Make Admin"})})]},t.id))})]})}),"sensors"===u&&(0,s.jsx)("div",{style:{background:"var(--bg-card)",borderRadius:"var(--border-radius)",overflow:"hidden"},children:(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[(0,s.jsx)("th",{style:{padding:"16px",textAlign:"left"},children:"Sensor"}),(0,s.jsx)("th",{style:{padding:"16px",textAlign:"left"},children:"Status"}),(0,s.jsx)("th",{style:{padding:"16px",textAlign:"center"},children:"Versions"}),(0,s.jsx)("th",{style:{padding:"16px",textAlign:"center"},children:"Downloads"}),(0,s.jsx)("th",{style:{padding:"16px",textAlign:"right"},children:"Actions"})]})}),(0,s.jsxs)("tbody",{children:[p.map(e=>(0,s.jsxs)("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[(0,s.jsxs)("td",{style:{padding:"16px"},children:[(0,s.jsx)("div",{style:{fontWeight:"600"},children:e.display_name}),e.github_pr_url&&(0,s.jsx)("a",{href:e.github_pr_url,target:"_blank",rel:"noopener noreferrer",style:{fontSize:"0.8rem",color:"var(--accent-primary)"},children:"View PR ↗"})]}),(0,s.jsx)("td",{style:{padding:"16px"},children:"certified"===e.status?(0,s.jsx)("span",{className:"badge badge-certified",children:"Certified"}):"approved"===e.status?(0,s.jsx)("span",{className:"badge badge-approved",children:"Approved"}):(0,s.jsx)("span",{className:"badge badge-pending",children:"Pending"})}),(0,s.jsx)("td",{style:{padding:"16px",textAlign:"center"},children:e.version_count}),(0,s.jsx)("td",{style:{padding:"16px",textAlign:"center"},children:e.total_downloads}),(0,s.jsx)("td",{style:{padding:"16px",textAlign:"right"},children:(0,s.jsxs)("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:["pending"===e.status&&(0,s.jsx)("button",{onClick:()=>A(e.id,"approved"),className:"btn btn-primary",style:{padding:"4px 12px",fontSize:"0.8rem",background:"var(--success)"},children:"Approve"}),"certified"!==e.status&&(0,s.jsx)("button",{onClick:()=>A(e.id,"certified"),className:"btn btn-primary",style:{padding:"4px 12px",fontSize:"0.8rem"},children:"Certify"}),"certified"===e.status&&(0,s.jsx)("button",{onClick:()=>A(e.id,"approved"),className:"btn btn-outline",style:{padding:"4px 12px",fontSize:"0.8rem"},children:"Decertify"}),(0,s.jsx)("button",{onClick:()=>g(e),className:"btn btn-outline",style:{padding:"4px 12px",fontSize:"0.8rem"},children:"Edit"}),(0,s.jsx)("button",{onClick:()=>k(e.id),className:"btn btn-outline",style:{padding:"4px 12px",fontSize:"0.8rem",color:"var(--error)",borderColor:"var(--error)"},children:"Delete"})]})})]},e.id)),0===p.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:5,style:{padding:"40px",textAlign:"center",color:"var(--text-muted)"},children:"No sensors yet"})})]})]})}),h&&(0,s.jsx)("div",{className:"modal-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(5, 15, 52, 0.7)",backdropFilter:"blur(12px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:(0,s.jsxs)("div",{className:"sensor-card",style:{maxWidth:"550px",width:"100%",maxHeight:"90vh",overflowY:"auto",border:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:"var(--shadow-lg)",background:"var(--bg-card)",padding:"32px",position:"relative"},children:[(0,s.jsx)("button",{onClick:()=>g(null),style:{position:"absolute",top:"24px",right:"24px",background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",fontSize:"1.8rem",lineHeight:1},children:"\xd7"}),(0,s.jsx)("h2",{style:{marginBottom:"8px",fontSize:"1.8rem",fontWeight:"800",background:"var(--accent-gradient)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Edit Sensor"}),(0,s.jsxs)("p",{style:{color:"var(--text-muted)",marginBottom:"32px",fontSize:"0.9rem"},children:["Refine the metadata for ",(0,s.jsx)("strong",{children:h.slug})]}),(0,s.jsxs)("div",{style:{display:"grid",gap:"24px"},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"0.8rem",fontWeight:"700",color:"var(--text-secondary)",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Display Name"}),(0,s.jsx)("input",{type:"text",className:"search-input",style:{padding:"12px 16px",fontSize:"1rem"},value:h.display_name,onChange:e=>g({...h,display_name:e.target.value})})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"0.8rem",fontWeight:"700",color:"var(--text-secondary)",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Category"}),(0,s.jsxs)("select",{className:"search-input",style:{padding:"12px 16px",fontSize:"1rem"},value:h.category,onChange:e=>g({...h,category:e.target.value}),children:[(0,s.jsx)("option",{value:"network",children:"Network"}),(0,s.jsx)("option",{value:"cloud",children:"Cloud"}),(0,s.jsx)("option",{value:"iot",children:"IoT"}),(0,s.jsx)("option",{value:"storage",children:"Storage"}),(0,s.jsx)("option",{value:"database",children:"Database"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"0.8rem",fontWeight:"700",color:"var(--text-secondary)",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Tags"}),(0,s.jsx)("input",{type:"text",className:"search-input",style:{padding:"12px 16px",fontSize:"1rem"},placeholder:"Comma separated...",value:Array.isArray(h.tags)?h.tags.join(", "):h.tags,onChange:e=>g({...h,tags:e.target.value.split(",").map(e=>e.trim())})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"0.8rem",fontWeight:"700",color:"var(--text-secondary)",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Description"}),(0,s.jsx)("textarea",{className:"search-input",style:{minHeight:"160px",padding:"16px",fontSize:"1rem",resize:"vertical",lineHeight:"1.6"},value:h.description,onChange:e=>g({...h,description:e.target.value})})]})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:"16px",justifyContent:"flex-end",marginTop:"40px"},children:[(0,s.jsx)("button",{className:"btn btn-outline",style:{padding:"12px 24px",minWidth:"120px"},onClick:()=>g(null),children:"Cancel"}),(0,s.jsx)("button",{className:"btn btn-primary",style:{padding:"12px 32px",minWidth:"160px"},onClick:()=>C(h.id,{display_name:h.display_name,description:h.description,category:h.category,tags:h.tags}),children:"Save Changes"})]})]})})]}):(0,s.jsxs)("div",{className:"container",style:{padding:"80px 24px",textAlign:"center"},children:[(0,s.jsx)("h1",{style:{color:"var(--error)"},children:"Access Denied"}),(0,s.jsx)("p",{style:{color:"var(--text-muted)",marginTop:"16px"},children:"You do not have admin privileges."})]}):(0,s.jsxs)("div",{className:"container",style:{padding:"80px 24px",textAlign:"center"},children:[(0,s.jsx)("h1",{children:"Admin Dashboard"}),(0,s.jsx)("p",{style:{color:"var(--text-muted)",marginTop:"16px"},children:"Please login to access the admin dashboard."})]})}},8818:(e,t,r)=>{"use strict";r.d(t,{A:()=>d,AuthProvider:()=>l});var s=r(5155),n=r(2115),a=r(5704);let i=(0,n.createContext)(void 0),o=a.env.NEXT_PUBLIC_API_URL||"/api/v1";function l(e){let{children:t}=e,[r,a]=(0,n.useState)(null),[l,d]=(0,n.useState)(null),[c,p]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=localStorage.getItem("auth_token");e?(d(e),x(e)):p(!1)},[]);let x=async e=>{try{let t=await fetch("".concat(o,"/auth/me"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();a(e)}else localStorage.removeItem("auth_token"),d(null)}catch(e){console.error("Failed to fetch user:",e)}finally{p(!1)}};return(0,s.jsx)(i.Provider,{value:{user:r,token:l,loading:c,login:()=>{window.location.href="".concat(o,"/auth/github")},logout:()=>{localStorage.removeItem("auth_token"),a(null),d(null)},completeLogin:e=>{localStorage.setItem("auth_token",e),d(e),x(e)}},children:t})}function d(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[441,255,358],()=>e(e.s=4220)),_N_E=e.O()}]);