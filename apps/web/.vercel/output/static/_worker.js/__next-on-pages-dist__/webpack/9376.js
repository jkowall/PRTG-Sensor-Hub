var h={},$=(p,b,y)=>(h.__chunk_9376=(f,u,g)=>{"use strict";g.d(u,{X:()=>d});class d{constructor(e,t,s){this.baseUrl="https://api.github.com",this.token=e,this.owner=t,this.repo=s}async request(e,t="GET",s){let r=`${this.baseUrl}/repos/${this.owner}/${this.repo}${e}`,n={Authorization:`Bearer ${this.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json","User-Agent":"PRTG-Sensor-Hub-Bot"};console.log(`GitHub Request: ${t} ${r}`);let o=await fetch(r,{method:t,headers:n,body:s?JSON.stringify(s):void 0});if(!o.ok){let a=await o.json();throw console.error("GitHub API Error:",a),Error(`GitHub API Error: ${a.message||JSON.stringify(a)}`)}return o.json()}async getRef(e){return this.request(`/git/ref/${e}`)}async createBlob(e,t="utf-8"){return this.request("/git/blobs","POST",{content:e,encoding:t})}async createTree(e,t){return this.request("/git/trees","POST",{base_tree:e,tree:t})}async createCommit(e,t,s){return this.request("/git/commits","POST",{message:e,tree:t,parents:[s]})}async createRef(e,t){return this.request("/git/refs","POST",{ref:`refs/heads/${e}`,sha:t})}async createPullRequest(e,t,s,r){return this.request("/pulls","POST",{title:e,body:t,head:s,base:r})}async createPrForFile(e,t,s,r,n){let o=(await this.getRef("heads/main")).object.sha;console.log("Latest Commit SHA:",o);let a=await this.createBlob(e.content,e.encoding||"utf-8");console.log("Blob created:",a.sha);let i=await this.createTree(o,[{path:e.path,mode:"100644",type:"blob",sha:a.sha}]);console.log("Tree created:",i.sha);let l=await this.createCommit(s,i.sha,o);console.log("Commit created:",l.sha),await this.createRef(t,l.sha),console.log("Branch created:",t);let c=await this.createPullRequest(r,n,t,"main");return console.log("PR created:",c.html_url),c}async closePullRequest(e){let t=`${this.baseUrl}/repos/${this.owner}/${this.repo}/pulls/${e}`,s={Authorization:`Bearer ${this.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json","User-Agent":"PRTG-Sensor-Hub-Bot"};console.log(`Closing PR #${e} (Rollback)...`);try{let r=await fetch(t,{method:"PATCH",headers:s,body:JSON.stringify({state:"closed"})});if(r.ok)console.log(`PR #${e} closed successfully.`);else{let n=await r.json();console.error("Failed to close PR:",n)}}catch(r){console.error("Error closing PR:",r)}}async getPullRequest(e){return this.request(`/pulls/${e}`)}async deleteRef(e){return this.request(`/git/refs/heads/${e}`,"DELETE")}async getContents(e){return this.request(`/contents/${e}`)}async deleteFile(e,t,s){return this.request(`/contents/${e}`,"DELETE",{message:t,sha:s})}}},h);export{$ as __getNamedExports};
